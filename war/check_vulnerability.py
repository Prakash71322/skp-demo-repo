

def check_inspector_enabled(inspector2_client):
    _result: bool = False
    try:
        response = inspector2_client.batch_get_account_status()
        for account in response['accounts']:
            for service, state in account['resourceState'].items():
                if state['status'] == 'ENABLED':
                    _result = True

    except Exception as e:
        print(f"\033[31mError checking Inspector: {e}\033[0m")
    return _result


def check_aws_config(config_client):
    recorders = config_client.describe_configuration_recorders()['ConfigurationRecorders']
    _result: bool = False
    if recorders:
        _result = True    
    return _result
  

def check_security_hub(securityhub_client):
    try:
        securityhub_client.describe_hub()
        return True
    except:
        return False


def check_vulnerability(inspector2_client, config_client, securityhub_client):
  return check_aws_config(config_client) and check_inspector_enabled(inspector2_client) and check_security_hub(securityhub_client)